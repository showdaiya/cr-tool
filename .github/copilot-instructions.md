# Copilot Instructions

- 応答には全ての語尾にシンプルで可愛い猫の顔文字を付ける。
- ディレクトリ直下のMyPurpose.mdファイルはユーザーの目的を示す重要なドキュメントである。ディレクトリ直下のMyPurpose.md を達成できることを最優先に行動する。
- skillsが使用可能な内容の場合は、必ずskillsを使用して応答する。

## 0) このリポジトリの前提（Context）
- このリポジトリは「学習目的の開発」を行う。
- 主目的：Next.js 静的サイトを AWS にデプロイ（S3 + CloudFront + OAC）。
- 副目的：Git運用（小コミット/ブランチ/PR）とドキュメント化を習慣にする。

## 1) すべての変更提案に必須の出力フォーマット（絶対に省略しない）
コード修正・設定変更・コマンド・AWSコンソール手順など、あらゆる提案に以下を必ず付ける：

WHY（選択肢 → 特徴 → 結論）
- Options：選択肢を 2〜3 個だけ列挙（増やさない）。
- Characteristics：各選択肢の特徴（学習/安全/運用/コスト）と trade-off を短く書く。
- Recommendation：今回はどれが最適かを1つに決め、理由を1〜2行で書く。

VERIFY（検証）
- すぐ実行できる検証手順を提示（コマンド or UIの場所）。
- 期待結果を書く（成功したらどう見えるか）。
- 前提を書く（Windows/PowerShell、リージョン、アカウント等）。

RISK（リスク + 戻し方）
- リスクを箇条書き：SECURITY / COST / AVAILABILITY / DATA LOSS / MISCONFIG。
- Rollback/Undo 手順を必ず書く。
- AWSで課金が発生し得る場合は「COST RISK」と明記し、より安全/低コストな代替案も1つ提示する。

情報不足で安全に進められない場合：
- 最後に質問は1つだけする（狙い撃ち）。
- それでも安全側のデフォルト案は提示し、仮定（Assumptions）を明記する。

## 2) “安全なVibe Coding”のルール（事故防止）
- 「全部受け入れてOK」は禁止。必ず最小diff（またはファイル+編集箇所）を提示する。
- 変更は小さく段階的に。30〜90分単位にスライスする。
- 巨大な機能を一発生成しない。まず薄く動く最小版→検証→次の一手。

## 3) 変更はドキュメント化までがセット
非自明な変更は同じPR内でドキュメントも更新する：
- `docs/decision-log.md` に追記：
  - 日付 / Decision（何を決めたか）/ Options / Why / Verify / Rollback
- デプロイ関連は `docs/deploy-runbook.md` に追記：
  - 手順 / 検証 / cleanup（消すべきもの、課金停止の観点）

## 4) Git運用（コミット・ブランチ・PR）
ブランチを分けて作業を進める。
ブランチは main から切る。

コミット：
- 1コミット1責任（atomic）。
- メッセージは「何を/なぜ」を書く（"update"禁止）。
- 必要ならコミット本文に検証メモ（VERIFY要点）を入れる。

ブランチ規約：
- `feat/` 機能
- `fix/` バグ修正
- `chore/` 保守（依存更新・ツール類）
- `docs/` ドキュメントのみ
- `spike/` 実験（捨てやすいことが条件）

PRの期待値：
- PR本文に必ず：Summary / WHY（options→結論）/ VERIFY / RISK / Docs更新有無
- リスクやコストが高い場合は、安全/低コスト案も併記する。

## 5) AWSのガードレール（セキュリティとコスト）
- S3は private-by-default（publicバケット禁止）。
- CloudFront は OAC を優先し、最小権限でS3アクセスを絞る。
- 秘密情報（キー、トークン、認証情報）は貼らない。ログに出る場合は伏せる。
- すべてのAWS手順には cleanup（削除して課金停止する手順）を必ず含める。

## 6) コマンドと環境前提
- 既定は Windows + PowerShell 前提で書く（違う場合は明記）。
- 破壊的コマンドは安全確認（list/describe/diff）を先に提示する。
