# カードバトル計算アプリケーション仕様書

## 1. アプリケーション概要

このアプリケーションは、カードゲームのダメージ計算をベースにしたシミュレーションツールです。
攻撃側カードと防衛側カードの設定を行い、それらの相互作用による計算結果を確認することができます。

## 2. システム構成

### 2.1 技術スタック

- フロントエンド: React.js + TypeScript
- UIフレームワーク: Chakra UI
- 状態管理: React Context API
- データ管理: ローカルJSONファイル（DBは使用せず）

### 2.2 主要コンポーネント

- CardBattlePage: メインのゲーム画面
- AttackCardSection: 攻撃側カードを管理するセクション
- AttackCard: 個々の攻撃カード
- DefenceCard: 防衛側カード
- SelectAttackOverlay: 攻撃カード選択用オーバーレイ
- SelectDefenceOverlay: 防衛カード選択用オーバーレイ
- CardContext: カードデータ管理用のコンテキスト

## 3. データ構造

### 3.1 カードタイプ

- 部隊カード（Troop）: HPとダメージを持つ
- 呪文カード（Spell）: ダメージとタワーダメージを持つ

### 3.2 カードプロパティ

#### 基本カード情報（BaseCard）

- EnName: 英語名
- JpName: 日本語名
- Type: カードタイプ（"Troop"または"Spell"）
- Icon: アイコン画像ファイル名

#### 部隊カード（TroopCard）

- Hitpoints: ヒットポイント
- Damage: 攻撃力

#### 呪文カード（SpellCard）

- Damage: ダメージ値
- TowerDamage: タワーへのダメージ値

### 3.3 アタックカード

- CardKey: カード識別子
- Type: カードタイプ
- AttackNumber: 攻撃回数

## 4. 主要機能

### 4.1 防衛側カード選択

- 防衛側として使用するカードを選択
- 選択されたカードのHP、被ダメージ、残りHPを表示

### 4.2 攻撃側カード管理

- 複数の攻撃カードを追加可能
- カードごとにカード種類と攻撃回数を設定
- 攻撃カードの編集と削除

### 4.3 ダメージ計算

- 攻撃側カードのダメージ × 攻撃回数 = 総ダメージ
- 防衛側HPから総ダメージを引いた値 = 残りHP

## 5. 画面フロー

1. 初期画面：デフォルトの防衛カード（Knight）が表示される
2. 防衛カードの選択：「選択」ボタンから防衛カードを変更可能
3. 攻撃カードの追加：「追加」ボタンで攻撃カード枠を追加
4. 攻撃カードの設定：各攻撃カードに対して、カード種類と攻撃回数を設定
5. 計算結果確認：防衛カードの残りHPをリアルタイムで確認

## 6. データ管理

### 6.1 JSONデータ

- `CardData.json`ファイルにカードデータを保存
- ユーザーのセッション中の状態はReact Contextで管理
- データベースを使用せず、フロントエンドのみでアプリケーションを構成

### 6.2 状態管理

- `CardContext`で以下の状態を管理：
  - 全トループカードデータ
  - 全スペルカードデータ
  - 攻撃カードの状態
  - 防衛カードの状態

## 7. 将来的な拡張性

### 7.1 機能追加案

- 効果（バフ/デバフ）システムの実装
- ユーザーカスタムカードの作成

### 7.2 技術的拡張

- ローカルストレージを使用したセッション保存
- テーマのカスタマイズオプション

## 8. 運用コスト

- データベースを使用しないため、バックエンド運用コストがなし
- 静的ホスティングサービスのみで展開可能（例：GitHub Pages、Netlify、Vercel）
- カードデータの更新はJSONファイルの更新のみで対応可能

## 9. 制限事項

- オフライン環境での使用を前提
- ユーザー間データ共有機能はなし
- 大規模データの取り扱いには制限あり

## 10. セキュリティ

- クライアントサイドのみの実装のため、機密データは保持しない
- 外部APIとの連携なし

## 11. 技術的課題

- ブラウザのローカルストレージ制限に注意
- パフォーマンスのためのレンダリング最適化
- 複雑な計算ロジックのテスト
